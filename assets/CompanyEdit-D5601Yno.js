import{j as a,i as x,L as f,l as h,g as b,r as y,B as j,T as L,F as T,m as v}from"./index-DNJEeKpm.js";import{A as D}from"./AssignmentTable-WQn6JD0N.js";import{u as F}from"./useAssignmentsQueries-Co_IpW2q.js";import{D as k}from"./DataTable-C3y_MH3t.js";import{S as I}from"./SebraDialog-BWENW5TC.js";import{u as S,a as A,b as E,C as K}from"./useContactsMutations-cBmdBICt.js";import{u as R}from"./useContactsQueries-j1wWPP27.js";import{C as $}from"./ContentTabs-BqWvu53v.js";import{F as w}from"./useSnackbar-DnV5oDFI.js";import{u as B,a as U,b as N,C as V}from"./useCompaniesMutations-B7K3ERRn.js";import{a as H}from"./useCompaniesQueries-Q7RF9lWC.js";import"./useAssignmentsMutations-CNh29H6z.js";import"./index.esm-Bwd_M7fz.js";import"./useQueryParam-BJxc55vW.js";import"./Tooltip-BDeKyA8M.js";import"./Tabs-DOkCcy6A.js";import"./MoreHoriz-Chy5gdoT.js";const P=({contacts:i,isLoading:s,defaultValues:t})=>{const{mutate:r}=S(),{mutate:m}=A(),{mutate:c}=E();return a.jsx(k,{data:i,getRowId:e=>`${e.id}`,state:{isLoading:s},columns:[{accessorKey:"contactName",header:"Namn",Cell:({cell:e,row:n})=>a.jsx(x,{component:f,to:`/home/contacts/${n.original.id}`,children:e.getValue()})},{accessorKey:"email",header:"Email"},{accessorKey:"jobTitle",header:"Jobbtitel"},{accessorKey:"phone",header:"Telefonnummer"}],renderEditRowDialogContent:({row:e,table:n})=>a.jsx(I,{table:n,row:e,titles:{creating:"Lägg till kontakt",editing:"Redigera kontakt"},FormComponent:K,defaultValues:t}),onCreate:e=>r(e),onUpdate:e=>m(e),onDelete:e=>c(e)})},nt=()=>{const i=h(),s=b(),{data:t,isLoading:r}=H(i.id==="new"?void 0:i.id),{mutate:m}=B(),{mutate:c}=U(),{mutate:e}=N(),{data:n=[],isLoading:l}=R(),{data:d=[],isLoading:p}=F(),u=y.useMemo(()=>d.filter(o=>o.companyId===(t==null?void 0:t.id)),[d,t]),g=o=>{t?c(o):m(o,{onSuccess:C=>s(`/home/companies/${C.id}`)})};if(!r)return a.jsx(a.Fragment,{children:a.jsx(V,{formProps:{values:t},onSubmit:g,renderTopContent:()=>a.jsxs(j,{sx:{position:"relative",mt:1,mb:3},children:[a.jsx(L,{variant:"h4",color:"primary",children:t?"Redigera bolag":"Lägg till bolag"}),a.jsx(w,{sx:{position:"absolute",top:0,right:0},onDelete:t?()=>e(t,{onSuccess:()=>s("..")}):void 0,onCancel:()=>s(-1)})]}),renderBottomContent:()=>t&&a.jsx(T,{sx:{mt:1,minHeight:`calc(100vh - ${v}px - 1rem)`},children:a.jsx($,{tabs:[{id:"contacts",label:"Kontakter",content:a.jsx(P,{contacts:n.filter(o=>o.companyId===t.id),isLoading:l,defaultValues:{companyId:t.id}})},{id:"assignments",label:"Uppdrag",content:a.jsx(D,{assignments:u,isLoading:p,defaultValues:{companyId:t.id}})}]})})})})};export{nt as default};
