import{i as h,k as j,r as m,j as o,B as I,S as k,f as n,l as v,T as S,m as L}from"./index-BL1e2KlY.js";import{A as T}from"./AssignmentTable-CqHnF0tJ.js";import{u as y}from"./useAssignmentsQueries-BvYlK66z.js";import{u as A,I as B}from"./useInteractionsQueries-Ck9pEFfc.js";import{C as D}from"./ContentTabs-DRrr9dmb.js";import{a as F}from"./DataTable-DVJgmJ5T.js";import{F as w}from"./FlexGrow-Dg5b9XDE.js";import{f as E}from"./date-B0M1n4ue.js";import{u as H,a as M,b as N,C as P}from"./useContactsMutations-DuP7qMXT.js";import{a as R}from"./useContactsQueries-Bs1lhRji.js";import"./SebraDialog-B78GFirD.js";import"./useSnackbar-BDp2hnMN.js";import"./MoreHoriz-DiGy_mT8.js";import"./index.esm-9-f3ubhn.js";import"./Tooltip-CnuzcUnQ.js";import"./useAssignmentsMutations-ufwG5otz.js";import"./useCompaniesQueries-DZiIFdEt.js";import"./useQueryParam-BQvW-pWR.js";const et=()=>{const r=h(),s=j(),{data:t,isLoading:l}=R(r.id==="new"?void 0:Number(r.id)),{mutate:d}=H(),{mutate:p}=M(),{mutate:u}=N(),{data:i=[],isLoading:g}=y(),x=m.useMemo(()=>i.filter(a=>a.responsibleContacts.some(e=>e.contactId===(t==null?void 0:t.contactId))||a.externalContactId===(t==null?void 0:t.contactId)),[i,t]),{data:c=[],isLoading:f}=A(),C=m.useMemo(()=>c.filter(a=>a.contacts.some(e=>e.contactId===(t==null?void 0:t.contactId))),[c,t]),b=a=>{t?p(a):d(a,{onSuccess:e=>s(`/home/contacts/${e.contactId}`)})};if(!l)return o.jsx(P,{formProps:{values:t},onSubmit:b,renderTopContent:()=>o.jsxs(I,{sx:{position:"relative",mt:1,mb:3},children:[o.jsxs(k,{spacing:2,direction:"row",sx:{position:"absolute",right:0},children:[t&&o.jsx(F,{onClick:()=>u(t,{onSuccess:()=>s("..")}),children:a=>o.jsx(n,{variant:"outlined",color:"error",...v(a),children:"Ta bort"})}),o.jsx(n,{variant:"outlined",color:"primary",onClick:()=>s(-1),children:"Avbryt"}),o.jsx(n,{type:"submit",variant:"contained",color:"primary",children:"Spara"})]}),o.jsx(S,{variant:"h4",color:"primary",children:t?"Redigera kontakt":"Lägg till kontakt"})]}),renderBottomContent:()=>t&&o.jsx(w,{sx:{mt:1,minHeight:`calc(100vh - ${L}px - 1rem)`},children:o.jsx(D,{tabs:[{id:"interactions",label:"Interaktioner",content:o.jsx(B,{interactions:C,isLoading:f,defaultValues:{contacts:[t],interactionDate:E()}})},{id:"seeking",label:"Söker",content:o.jsx(o.Fragment,{children:"Söker..."})},{id:"assignments",label:"Uppdrag",content:o.jsx(T,{assignments:x,isLoading:g})}]})})})};export{et as default};
