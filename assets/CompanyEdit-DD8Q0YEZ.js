import{j as t,g as x,L as y,i as b,k as h,r as f,B as j,T as I,l as k}from"./index-BUM_MQF7.js";import{A as L}from"./AssignmentTable-Dct8iEcK.js";import{u as F}from"./useAssignmentsQueries-GaL0d8L9.js";import{D as T}from"./DataTable-IakPZlhB.js";import{S as v}from"./SebraDialog-Ch2Af9Fk.js";import{u as D,a as S,b as K,C as A}from"./useContactsMutations-C0_jwNaN.js";import{u as E}from"./useContactsQueries-G1HUU60J.js";import{C as R}from"./ContentTabs-Drl387Fu.js";import{F as $}from"./FlexGrow-azjmjJYQ.js";import{F as w}from"./useSnackbar-B64PA2kK.js";import{u as B,a as N,b as U,C as V}from"./useCompaniesMutations-CPM-GA7I.js";import{a as H}from"./useCompaniesQueries-ChmDKtcm.js";import"./useAssignmentsMutations-BWuCaglB.js";import"./index.esm-Cw-loWU6.js";import"./useQueryParam-DpE6DVf7.js";import"./Tooltip-CEz5gZ0-.js";import"./MoreHoriz-CDhh6dQ9.js";const P=({contacts:r,isLoading:n,defaultValues:e})=>{const{mutate:i}=D(),{mutate:m}=S(),{mutate:c}=K();return t.jsx(T,{data:r,getRowId:a=>`${a.contactId}`,state:{isLoading:n},columns:[{accessorKey:"contactName",header:"Namn",Cell:({cell:a,row:s})=>t.jsx(x,{component:y,to:`/home/contacts/${s.original.contactId}`,children:a.getValue()})},{accessorKey:"email",header:"Email"},{accessorKey:"jobTitle",header:"Jobbtitel"},{accessorKey:"phone",header:"Telefonnummer"}],renderEditRowDialogContent:({row:a,table:s})=>t.jsx(v,{table:s,row:a,titles:{creating:"Lägg till kontakt",editing:"Redigera kontakt"},FormComponent:A,defaultValues:e}),onCreate:a=>i(a),onUpdate:a=>m(a),onDelete:a=>c(a)})},st=()=>{const r=b(),n=h(),{data:e,isLoading:i}=H(r.id==="new"?void 0:Number(r.id)),{mutate:m}=B(),{mutate:c}=N(),{mutate:a}=U(),{data:s=[],isLoading:d}=E(),{data:l=[],isLoading:p}=F(),u=f.useMemo(()=>l.filter(o=>o.companyId===(e==null?void 0:e.companyId)),[l,e]),g=o=>{e?c(o):m(o,{onSuccess:C=>n(`/home/companies/${C.companyId}`)})};if(!i)return t.jsx(t.Fragment,{children:t.jsx(V,{formProps:{values:e},onSubmit:g,renderTopContent:()=>t.jsxs(j,{sx:{position:"relative",mt:1,mb:3},children:[t.jsx(I,{variant:"h4",color:"primary",children:e?"Redigera bolag":"Lägg till bolag"}),t.jsx(w,{sx:{position:"absolute",top:0,right:0},onDelete:e?()=>a(e,{onSuccess:()=>n("..")}):void 0,onCancel:()=>n(-1)})]}),renderBottomContent:()=>e&&t.jsx($,{sx:{mt:1,minHeight:`calc(100vh - ${k}px - 1rem)`},children:t.jsx(R,{tabs:[{id:"interactions",label:"Interaktioner",content:t.jsx(t.Fragment,{children:"Interaktioner..."})},{id:"contacts",label:"Kontakter",content:t.jsx(P,{contacts:s.filter(o=>o.companyId===e.companyId),isLoading:d,defaultValues:{companyId:e.companyId}})},{id:"seeking",label:"Söker",content:t.jsx(t.Fragment,{children:"Söker..."})},{id:"assignments",label:"Uppdrag",content:t.jsx(L,{assignments:u,isLoading:p,defaultValues:{companyId:e.companyId}})},{id:"kyc",label:"KYC",content:t.jsx(t.Fragment,{children:"KYC..."})}]})})})})};export{st as default};
