import{j as a,i as C,L as b,l as y,g as x,r as h,B as j,T as D,F as I,m as L}from"./index-YJqmW9KL.js";import{A as v}from"./AssignmentTable-D1cHGx1l.js";import{u as w}from"./useAssignmentsQueries-CwSf4xVb.js";import{D as T}from"./DataTable-BE7cnjIV.js";import{S as k}from"./SebraDialog-CUzs_nj7.js";import{u as F,a as E,b as S,C as A}from"./useContactsMutations-C3zmE2pd.js";import{u as K}from"./useContactsQueries-BDDHK5Vo.js";import{C as R}from"./ContentTabs-B5fbURPj.js";import{F as $}from"./SebraForm-BHSdrVvv.js";import{u as B,a as U,b as _,C as N}from"./useCompaniesMutations-B3SrEh7H.js";import{a as V}from"./useCompaniesQueries-NfGHUcxQ.js";import"./useAssignmentsMutations-C88PMQrZ.js";import"./index.esm-Ckl5Vq71.js";import"./useQueryParam-mKhBW43I.js";import"./Tooltip-Bq157Mjh.js";import"./Tabs-C1En54He.js";import"./MoreHoriz-x6EIQjlA.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},s=new o.Error().stack;s&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[s]="f8f7e966-69af-453e-827f-5292a4b0f308",o._sentryDebugIdIdentifier="sentry-dbid-f8f7e966-69af-453e-827f-5292a4b0f308")}catch{}})();const H=({contacts:o,isLoading:s,defaultValues:t})=>{const{mutate:r}=F(),{mutate:m}=E(),{mutate:c}=S();return a.jsx(T,{data:o,getRowId:e=>`${e.id}`,state:{isLoading:s},columns:[{accessorKey:"contactName",header:"Namn",Cell:({cell:e,row:i})=>a.jsx(C,{component:b,to:`/home/contacts/${i.original.id}`,children:e.getValue()})},{accessorKey:"email",header:"Email"},{accessorKey:"jobTitle",header:"Jobbtitel"},{accessorKey:"phone",header:"Telefonnummer"}],renderEditRowDialogContent:({row:e,table:i})=>a.jsx(k,{table:i,row:e,titles:{creating:"Lägg till kontakt",editing:"Redigera kontakt"},FormComponent:A,defaultValues:t}),onCreate:e=>r(e),onUpdate:e=>m(e),onDelete:e=>c(e)})},nt=()=>{const o=y(),s=x(),{data:t,isLoading:r}=V(o.id==="new"?void 0:o.id),{mutate:m}=B(),{mutate:c}=U(),{mutate:e}=_(),{data:i=[],isLoading:l}=K(),{data:d=[],isLoading:p}=w(),u=h.useMemo(()=>d.filter(n=>n.companyId===(t==null?void 0:t.id)),[d,t]),g=n=>{t?c(n):m(n,{onSuccess:f=>s(`/home/companies/${f.id}`)})};if(!r)return a.jsx(a.Fragment,{children:a.jsx(N,{formProps:{values:t},onSubmit:g,renderTopContent:()=>a.jsxs(j,{sx:{position:"relative",mt:1,mb:3},children:[a.jsx(D,{variant:"h4",color:"primary",children:t?"Redigera bolag":"Lägg till bolag"}),a.jsx($,{sx:{position:"absolute",top:0,right:0},onDelete:t?()=>e(t,{onSuccess:()=>s("..")}):void 0,onCancel:()=>s(-1)})]}),renderBottomContent:()=>t&&a.jsx(I,{sx:{mt:1,minHeight:`calc(100vh - ${L}px - 1rem)`},children:a.jsx(R,{tabs:[{id:"contacts",label:"Kontakter",content:a.jsx(H,{contacts:i.filter(n=>n.companyId===t.id),isLoading:l,defaultValues:{companyId:t.id}})},{id:"assignments",label:"Uppdrag",content:a.jsx(v,{assignments:u,isLoading:p,defaultValues:{companyId:t.id}})}]})})})})};export{nt as default};
//# sourceMappingURL=CompanyEdit-DgrAmc6V.js.map
