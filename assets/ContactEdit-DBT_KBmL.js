import{i as h,k as j,r as m,j as o,B as I,S as k,f as n,l as v,T as S,m as L}from"./index-4JUCeTbF.js";import{A as T}from"./AssignmentTable-jjEHSgda.js";import{u as y}from"./useAssignmentsQueries-DBy_n-_-.js";import{u as A,I as D}from"./useInteractionsQueries-Bjez-Fpd.js";import{C as B}from"./ContentTabs-DHGXFkbg.js";import{D as F}from"./SebraDialog-CxgIUny0.js";import{F as w}from"./FlexGrow-DzYTkLTw.js";import{f as E}from"./date-DKIv-wQj.js";import{u as H,a as M,b as N,C as P}from"./useContactsMutations-DELdJmLF.js";import{a as R}from"./useContactsQueries-BH5dhfZS.js";import"./DataTable-CKBkIaRG.js";import"./useSnackbar-CkwChgxw.js";import"./MoreHoriz-DBfnw4jB.js";import"./index.esm-eScS0gA7.js";import"./Tooltip-D5iUx3eh.js";import"./useQueryParam-DhHureY5.js";import"./useAssignmentsMutations-CuGBAZCB.js";import"./useCompaniesQueries-Z68uJHif.js";const et=()=>{const r=h(),s=j(),{data:t,isLoading:l}=R(r.id==="new"?void 0:Number(r.id)),{mutate:d}=H(),{mutate:p}=M(),{mutate:u}=N(),{data:i=[],isLoading:g}=y(),x=m.useMemo(()=>i.filter(a=>a.responsibleContacts.some(e=>e.contactId===(t==null?void 0:t.contactId))||a.externalContactId===(t==null?void 0:t.contactId)),[i,t]),{data:c=[],isLoading:f}=A(),C=m.useMemo(()=>c.filter(a=>a.contacts.some(e=>e.contactId===(t==null?void 0:t.contactId))),[c,t]),b=a=>{t?p(a):d(a,{onSuccess:e=>s(`/home/contacts/${e.contactId}`)})};if(!l)return o.jsx(P,{formProps:{values:t},onSubmit:b,renderTopContent:()=>o.jsxs(I,{sx:{position:"relative",mt:1,mb:3},children:[o.jsxs(k,{spacing:2,direction:"row",sx:{position:"absolute",right:0},children:[t&&o.jsx(F,{onClick:()=>u(t,{onSuccess:()=>s("..")}),children:a=>o.jsx(n,{variant:"outlined",color:"error",...v(a),children:"Ta bort"})}),o.jsx(n,{variant:"outlined",color:"primary",onClick:()=>s(-1),children:"Avbryt"}),o.jsx(n,{type:"submit",variant:"contained",color:"primary",children:"Spara"})]}),o.jsx(S,{variant:"h4",color:"primary",children:t?"Redigera kontakt":"Lägg till kontakt"})]}),renderBottomContent:()=>t&&o.jsx(w,{sx:{mt:1,minHeight:`calc(100vh - ${L}px - 1rem)`},children:o.jsx(B,{tabs:[{id:"interactions",label:"Interaktioner",content:o.jsx(D,{interactions:C,isLoading:f,defaultValues:{contacts:[t],interactionDate:E()}})},{id:"seeking",label:"Söker",content:o.jsx(o.Fragment,{children:"Söker..."})},{id:"assignments",label:"Uppdrag",content:o.jsx(T,{assignments:x,isLoading:g})}]})})})};export{et as default};
