import{j as a,g as k,L as v,i as I,k as D,T,B as u,S as L,f as p,l as F}from"./index-BcagG063.js";import{A as S}from"./AssignmentTable-CLfXPur6.js";import{u as K}from"./useAssignmentsQueries-D4iLpn_8.js";import{D as g,a as x,b as C,M as h}from"./useSnackbar-VbT7i0G6.js";import{D as R,a as A}from"./DataTable-g328pMvS.js";import{u as E,a as N,b as P,C as j}from"./useContactsMutations-CCP9OQTc.js";import{u as B}from"./useContactsQueries-D-k2Repl.js";import{C as U}from"./ContentTabs-DgON2HBY.js";import{F as $}from"./FlexGrow-KbRxJb9s.js";import{u as w,a as z,b as V,C as _}from"./useCompaniesMutations-ClXNltZE.js";import{a as M}from"./useCompaniesQueries-qsC-vERy.js";import"./useAssignmentsMutations-DXheS63y.js";import"./index.esm-IRtN4Gqm.js";import"./MoreHoriz-BFMv-1Vu.js";import"./Tooltip-CjWYkGeA.js";import"./useQueryParam-DLn3SgfO.js";const Y=({contacts:i,isLoading:s,defaultValues:e})=>{const{mutate:m}=E(),{mutate:l}=N(),{mutate:d}=P();return a.jsx(R,{data:i,getRowId:t=>`${t.contactId}`,state:{isLoading:s},columns:[{accessorKey:"contactName",header:"Namn",Cell:({cell:t,row:o})=>a.jsx(k,{component:v,to:`/dashboard/contacts/${o.original.contactId}`,children:t.getValue()})},{accessorKey:"email",header:"Email"},{accessorKey:"jobTitle",header:"Jobbtitel"},{accessorKey:"phone",header:"Telefonnummer"}],renderCreateRowDialogContent:({row:t,table:o})=>a.jsxs(a.Fragment,{children:[a.jsx(g,{variant:"h4",color:"primary",children:"Ny kontakt"}),a.jsx(x,{children:a.jsx(j,{sx:{mt:1},formProps:{defaultValues:e},onChange:r=>{t._valuesCache=r}})}),a.jsx(C,{children:a.jsx(h,{row:t,table:o,variant:"text"})})]}),renderEditRowDialogContent:({row:t,table:o})=>a.jsxs(a.Fragment,{children:[a.jsx(g,{variant:"h4",color:"primary",children:"Redigera kontakt"}),a.jsx(x,{children:a.jsx(j,{sx:{mt:1},formProps:{defaultValues:t.original},onChange:r=>{t._valuesCache=r}})}),a.jsx(C,{children:a.jsx(h,{row:t,table:o,variant:"text"})})]}),onCreate:t=>m(t),onUpdate:t=>l(t),onDelete:t=>d(t)})},ia=()=>{const i=I(),s=D(),{data:e,isLoading:m}=M(i.id==="new"?void 0:Number(i.id)),{mutate:l}=w(),{mutate:d}=z(),{mutate:t}=V(),{data:o=[],isLoading:r}=B(),{data:y=[],isLoading:f}=K(),b=n=>{e?d(n):l(n,{onSuccess:c=>s(`/dashboard/companies/${c.companyId}`)})};if(!m)return a.jsxs(a.Fragment,{children:[a.jsx(T,{variant:"h4",color:"primary",children:e?"Redigera företag":"Lägg till företag"}),a.jsx(u,{sx:{my:1}}),a.jsxs(_,{formProps:{values:e},onSubmit:b,children:[a.jsx(u,{sx:{my:1}}),e&&a.jsx($,{children:a.jsx(U,{tabs:[{id:"interactions",label:"Interaktioner",content:a.jsx(a.Fragment,{children:"Interaktioner..."})},{id:"contacts",label:"Kontakter",content:a.jsx(Y,{contacts:o.filter(n=>n.companyId===e.companyId),isLoading:r,defaultValues:{companyId:e.companyId}})},{id:"seeking",label:"Söker",content:a.jsx(a.Fragment,{children:"Söker..."})},{id:"assignments",label:"Uppdrag",content:a.jsx(S,{assignments:y.filter(n=>{var c;return((c=n.externalContactPerson)==null?void 0:c.companyId)===e.companyId}),isLoading:f})},{id:"kyc",label:"KYC",content:a.jsx(a.Fragment,{children:"KYC..."})}]})}),a.jsxs(L,{spacing:2,direction:"row",sx:{mt:3,ml:"auto"},children:[e&&a.jsx(A,{onClick:()=>t(e,{onSuccess:()=>s("..")}),children:n=>a.jsx(p,{size:"large",variant:"outlined",color:"error",...F(n),children:"Ta bort"})}),a.jsx(p,{size:"large",variant:"outlined",color:"primary",onClick:()=>s(-1),children:"Avbryt"}),a.jsx(p,{size:"large",type:"submit",variant:"contained",color:"primary",children:"Spara"})]})]})]})};export{ia as default};
