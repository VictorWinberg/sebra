import{j as t,g as x,L as h,i as y,k as j,B as b,S as f,f as p,l as k,T as v,m as I}from"./index-Bd6xTruv.js";import{A as T}from"./AssignmentTable-Dm3QLELP.js";import{u as L}from"./useAssignmentsQueries-BVl8YA9L.js";import{D,a as S,b as F,M as K}from"./useSnackbar-DAvCiuvm.js";import{D as R,a as A}from"./DataTable-Bn-3yvjr.js";import{u as B,a as E,b as $,C as w}from"./useContactsMutations-L2w66Qa1.js";import{u as N}from"./useContactsQueries-BES7-iDj.js";import{C as P}from"./ContentTabs-DqNb2H1a.js";import{F as U}from"./FlexGrow-ErFmPyPr.js";import{u as V,a as H,b as M,C as Y}from"./useCompaniesMutations-KYVRp3RD.js";import{a as _}from"./useCompaniesQueries-DHFwAocb.js";import"./useAssignmentsMutations-DZtx__Uh.js";import"./index.esm-BJZkzNMk.js";import"./MoreHoriz-BvVezgON.js";import"./Tooltip-Di0BuYhK.js";import"./useQueryParam-B3HxR5Y7.js";const G=({contacts:r,isLoading:s,defaultValues:e})=>{const{mutate:c}=B(),{mutate:m}=E(),{mutate:l}=$();return t.jsx(R,{data:r,getRowId:a=>`${a.contactId}`,state:{isLoading:s},columns:[{accessorKey:"contactName",header:"Namn",Cell:({cell:a,row:o})=>t.jsx(x,{component:h,to:`/home/contacts/${o.original.contactId}`,children:a.getValue()})},{accessorKey:"email",header:"Email"},{accessorKey:"jobTitle",header:"Jobbtitel"},{accessorKey:"phone",header:"Telefonnummer"}],renderEditRowDialogContent:({row:a,table:o})=>t.jsxs(t.Fragment,{children:[t.jsx(D,{variant:"h4",color:"primary",children:o.getState().creatingRow?"Lägg till kontakt":"Redigera kontakt"}),t.jsx(S,{children:t.jsx(w,{sx:{mt:1},formProps:{defaultValues:{...e,...a.original}},onChange:d=>{a._valuesCache=d}})}),t.jsx(F,{children:t.jsx(K,{row:a,table:o,variant:"text"})})]}),onCreate:a=>c(a),onUpdate:a=>m(a),onDelete:a=>l(a)})},ct=()=>{const r=y(),s=j(),{data:e,isLoading:c}=_(r.id==="new"?void 0:Number(r.id)),{mutate:m}=V(),{mutate:l}=H(),{mutate:a}=M(),{data:o=[],isLoading:d}=N(),{data:g=[],isLoading:u}=L(),C=n=>{e?l(n):m(n,{onSuccess:i=>s(`/home/companies/${i.companyId}`)})};if(!c)return t.jsx(t.Fragment,{children:t.jsx(Y,{formProps:{values:e},onSubmit:C,renderTopContent:()=>t.jsxs(b,{sx:{position:"relative",mt:1,mb:3},children:[t.jsxs(f,{spacing:2,direction:"row",sx:{position:"absolute",right:0},children:[e&&t.jsx(A,{onClick:()=>a(e,{onSuccess:()=>s("..")}),children:n=>t.jsx(p,{variant:"outlined",color:"error",...k(n),children:"Ta bort"})}),t.jsx(p,{variant:"outlined",color:"primary",onClick:()=>s(-1),children:"Avbryt"}),t.jsx(p,{type:"submit",variant:"contained",color:"primary",children:"Spara"})]}),t.jsx(v,{variant:"h4",color:"primary",children:e?"Redigera bolag":"Lägg till bolag"})]}),renderBottomContent:()=>e&&t.jsx(U,{sx:{mt:1,minHeight:`calc(100vh - ${I}px - 1rem)`},children:t.jsx(P,{tabs:[{id:"interactions",label:"Interaktioner",content:t.jsx(t.Fragment,{children:"Interaktioner..."})},{id:"contacts",label:"Kontakter",content:t.jsx(G,{contacts:o.filter(n=>n.companyId===e.companyId),isLoading:d,defaultValues:{companyId:e.companyId}})},{id:"seeking",label:"Söker",content:t.jsx(t.Fragment,{children:"Söker..."})},{id:"assignments",label:"Uppdrag",content:t.jsx(T,{assignments:g.filter(n=>{var i;return((i=n.externalContactPerson)==null?void 0:i.companyId)===e.companyId}),isLoading:u})},{id:"kyc",label:"KYC",content:t.jsx(t.Fragment,{children:"KYC..."})}]})})})})};export{ct as default};
