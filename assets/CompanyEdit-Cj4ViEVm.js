import{j as e,h as y,L as x,k as h,l as b,r as f,B as j,T as I,F as L,m as T}from"./index-Bu3rOK7V.js";import{A as k}from"./AssignmentTable-DB-K82WI.js";import{u as v}from"./useAssignmentsQueries-Co2M987s.js";import{D}from"./DataTable-BWWCIday.js";import{S as F}from"./SebraDialog-Cp7YvpgL.js";import{u as S,a as A,b as E,C as K}from"./useContactsMutations-BKpY6pbV.js";import{u as R}from"./useContactsQueries-Db7kIYmR.js";import{C as $}from"./ContentTabs-DGwG71H3.js";import{F as w}from"./useSnackbar-Az2rIrHh.js";import{u as B,a as N,b as U,C as V}from"./useCompaniesMutations-pg5Crxs2.js";import{a as H}from"./useCompaniesQueries-C6QYWY5n.js";import"./useAssignmentsMutations-DE7I7y92.js";import"./index.esm-Cy9lSAvS.js";import"./useQueryParam-B9TSpmma.js";import"./Tooltip-ZojcANpd.js";import"./Tabs-BKFvS1DG.js";import"./MoreHoriz-CelEMqih.js";const P=({contacts:r,isLoading:s,defaultValues:t})=>{const{mutate:m}=S(),{mutate:i}=A(),{mutate:c}=E();return e.jsx(D,{data:r,getRowId:a=>`${a.contactId}`,state:{isLoading:s},columns:[{accessorKey:"contactName",header:"Namn",Cell:({cell:a,row:n})=>e.jsx(y,{component:x,to:`/home/contacts/${n.original.contactId}`,children:a.getValue()})},{accessorKey:"email",header:"Email"},{accessorKey:"jobTitle",header:"Jobbtitel"},{accessorKey:"phone",header:"Telefonnummer"}],renderEditRowDialogContent:({row:a,table:n})=>e.jsx(F,{table:n,row:a,titles:{creating:"Lägg till kontakt",editing:"Redigera kontakt"},FormComponent:K,defaultValues:t}),onCreate:a=>m(a),onUpdate:a=>i(a),onDelete:a=>c(a)})},nt=()=>{const r=h(),s=b(),{data:t,isLoading:m}=H(r.id==="new"?void 0:Number(r.id)),{mutate:i}=B(),{mutate:c}=N(),{mutate:a}=U(),{data:n=[],isLoading:p}=R(),{data:d=[],isLoading:l}=v(),u=f.useMemo(()=>d.filter(o=>o.companyId===(t==null?void 0:t.companyId)),[d,t]),g=o=>{t?c(o):i(o,{onSuccess:C=>s(`/home/companies/${C.companyId}`)})};if(!m)return e.jsx(e.Fragment,{children:e.jsx(V,{formProps:{values:t},onSubmit:g,renderTopContent:()=>e.jsxs(j,{sx:{position:"relative",mt:1,mb:3},children:[e.jsx(I,{variant:"h4",color:"primary",children:t?"Redigera bolag":"Lägg till bolag"}),e.jsx(w,{sx:{position:"absolute",top:0,right:0},onDelete:t?()=>a(t,{onSuccess:()=>s("..")}):void 0,onCancel:()=>s(-1)})]}),renderBottomContent:()=>t&&e.jsx(L,{sx:{mt:1,minHeight:`calc(100vh - ${T}px - 1rem)`},children:e.jsx($,{tabs:[{id:"contacts",label:"Kontakter",content:e.jsx(P,{contacts:n.filter(o=>o.companyId===t.companyId),isLoading:p,defaultValues:{companyId:t.companyId}})},{id:"assignments",label:"Uppdrag",content:e.jsx(k,{assignments:u,isLoading:l,defaultValues:{companyId:t.companyId}})}]})})})})};export{nt as default};
