import{j as a,c as C,a as y,r as x,B as h,T as j,F as D,t as L}from"./index-COHkfauX.js";import{A as w}from"./AssignmentTable-B9WfrDTn.js";import{u as k}from"./useAssignmentsQueries--XuqzYRh.js";import{D as v}from"./DataTable-atYtnPQ3.js";import{R as T,F}from"./RouterLink-CGfKZOEK.js";import{S as I}from"./SebraDialog-CtEYrWw-.js";import{u as R,a as E,b as S,C as A}from"./useContactsMutations-hc39lRXj.js";import{L as K}from"./Link-CUpINFjZ.js";import{u as $}from"./useContactsQueries-YvFRwyOe.js";import{C as B}from"./ContentTabs-Dg_m06GM.js";import{u as U,a as _,b as N,C as V}from"./useCompaniesMutations-BmRCyIvZ.js";import{a as H}from"./useCompaniesQueries-CCldv5KA.js";import"./useAssignmentsMutations-DtX8UwuY.js";import"./index.esm-C06nyDwR.js";import"./useQueryParam-D9Q2bhRi.js";import"./Tooltip-CJHmJc4_.js";import"./MoreHoriz-DVW22PKN.js";import"./createStyled-DrqLeAQs.js";import"./FormControlLabel-BL2xfAsO.js";import"./Tabs-Bl51lW8A.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},n=new o.Error().stack;n&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[n]="c4e493ab-a702-417a-be71-acf27fd2b29a",o._sentryDebugIdIdentifier="sentry-dbid-c4e493ab-a702-417a-be71-acf27fd2b29a")}catch{}})();const P=({contacts:o,isLoading:n,defaultValues:i})=>{const{mutate:t}=R(),{mutate:c}=E(),{mutate:d}=S();return a.jsx(v,{data:o,getRowId:e=>`${e.id}`,state:{isLoading:n},columns:[{accessorKey:"contactName",header:"Namn",Cell:({cell:e,row:m})=>a.jsx(K,{component:T,to:`/home/contacts/${m.original.id}`,children:e.getValue()})},{accessorKey:"email",header:"Email"},{accessorKey:"jobTitle",header:"Jobbtitel"},{accessorKey:"phone",header:"Telefonnummer"}],renderEditRowDialogContent:({row:e,table:m})=>a.jsx(I,{table:m,row:e,titles:{creating:"Lägg till kontakt",editing:"Redigera kontakt"},FormComponent:A,defaultValues:i}),onCreate:e=>t(e),onUpdate:e=>c(e),onDelete:e=>d(e)})},ct=()=>{const{id:o,workspace:n}=C(),i=y(),{data:t,isLoading:c}=H(o==="new"?void 0:o),{mutate:d}=U(),{mutate:e}=_(),{mutate:m}=N(),{data:p=[],isLoading:u}=$(),{data:l=[],isLoading:g}=k(),f=x.useMemo(()=>l.filter(r=>{var s;return((s=r.company)==null?void 0:s.id)===(t==null?void 0:t.id)}),[l,t]),b=r=>{t?e({...r,id:t.id}):d(r,{onSuccess:({createCompany:s})=>i(`/${n}/home/companies/${(s==null?void 0:s.id)||""}`)})};if(!c)return a.jsx(a.Fragment,{children:a.jsx(V,{formProps:{values:t},onSubmit:b,renderTopContent:()=>a.jsxs(h,{sx:{position:"relative",mt:1,mb:3},children:[a.jsx(j,{variant:"h4",color:"primary",children:t?"Redigera bolag":"Lägg till bolag"}),a.jsx(F,{sx:{position:"absolute",top:0,right:0},onDelete:t?()=>m(t,{onSuccess:()=>i("..")}):void 0,onCancel:()=>i(-1)})]}),renderBottomContent:()=>t&&a.jsx(D,{sx:{mt:1,minHeight:`calc(100vh - ${L}px - 1rem)`},children:a.jsx(B,{tabs:[{id:"contacts",label:"Kontakter",content:a.jsx(P,{contacts:p.filter(r=>{var s;return((s=r.company)==null?void 0:s.id)===t.id}),isLoading:u,defaultValues:{company:t}})},{id:"assignments",label:"Uppdrag",content:a.jsx(w,{assignments:f,isLoading:g,defaultValues:{company:t}})}]})})})})};export{ct as default};
//# sourceMappingURL=CompanyEdit-f3sQgpd-.js.map
