import{j as a,c as C,a as y,r as x,B as h,T as j,F as D,t as L}from"./index-BH2J_HuR.js";import{A as w}from"./AssignmentTable-D8KjCzo1.js";import{u as k}from"./useAssignmentsQueries-XbTpcFwQ.js";import{D as v}from"./DataTable-Bd9UL0SB.js";import{R as T,F}from"./RouterLink-C91Clvog.js";import{S as I}from"./SebraDialog-COMSCFv8.js";import{u as R,a as E,b as S,C as A}from"./useContactsMutations-B6Hl1dau.js";import{L as K}from"./Link-DU-uYsY6.js";import{u as $}from"./useContactsQueries-p5mvKz3K.js";import{C as B}from"./ContentTabs-G2DaLu_h.js";import{u as U,a as _,b as N,C as V}from"./useCompaniesMutations-ldp7QNka.js";import{a as H}from"./useCompaniesQueries-YKOi_1YG.js";import"./useAssignmentsMutations-qdPxgWf9.js";import"./index.esm-MvbHuaO0.js";import"./useQueryParam-AqC46H1A.js";import"./Tooltip-xqQ1aCVd.js";import"./MoreHoriz-qe-M4Bo9.js";import"./createStyled-cSTNUJf9.js";import"./FormControlLabel-ChvPNSd4.js";import"./Tabs-C5jZbOSy.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},n=new o.Error().stack;n&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[n]="c4e493ab-a702-417a-be71-acf27fd2b29a",o._sentryDebugIdIdentifier="sentry-dbid-c4e493ab-a702-417a-be71-acf27fd2b29a")}catch{}})();const P=({contacts:o,isLoading:n,defaultValues:i})=>{const{mutate:t}=R(),{mutate:c}=E(),{mutate:d}=S();return a.jsx(v,{data:o,getRowId:e=>`${e.id}`,state:{isLoading:n},columns:[{accessorKey:"contactName",header:"Namn",Cell:({cell:e,row:m})=>a.jsx(K,{component:T,to:`/home/contacts/${m.original.id}`,children:e.getValue()})},{accessorKey:"email",header:"Email"},{accessorKey:"jobTitle",header:"Jobbtitel"},{accessorKey:"phone",header:"Telefonnummer"}],renderEditRowDialogContent:({row:e,table:m})=>a.jsx(I,{table:m,row:e,titles:{creating:"Lägg till kontakt",editing:"Redigera kontakt"},FormComponent:A,defaultValues:i}),onCreate:e=>t(e),onUpdate:e=>c(e),onDelete:e=>d(e)})},ct=()=>{const{id:o,workspace:n}=C(),i=y(),{data:t,isLoading:c}=H(o==="new"?void 0:o),{mutate:d}=U(),{mutate:e}=_(),{mutate:m}=N(),{data:p=[],isLoading:u}=$(),{data:l=[],isLoading:g}=k(),f=x.useMemo(()=>l.filter(r=>{var s;return((s=r.company)==null?void 0:s.id)===(t==null?void 0:t.id)}),[l,t]),b=r=>{t?e({...r,id:t.id}):d(r,{onSuccess:({createCompany:s})=>i(`/${n}/home/companies/${(s==null?void 0:s.id)||""}`)})};if(!c)return a.jsx(a.Fragment,{children:a.jsx(V,{formProps:{values:t},onSubmit:b,renderTopContent:()=>a.jsxs(h,{sx:{position:"relative",mt:1,mb:3},children:[a.jsx(j,{variant:"h4",color:"primary",children:t?"Redigera bolag":"Lägg till bolag"}),a.jsx(F,{sx:{position:"absolute",top:0,right:0},onDelete:t?()=>m(t,{onSuccess:()=>i("..")}):void 0,onCancel:()=>i(-1)})]}),renderBottomContent:()=>t&&a.jsx(D,{sx:{mt:1,minHeight:`calc(100vh - ${L}px - 1rem)`},children:a.jsx(B,{tabs:[{id:"contacts",label:"Kontakter",content:a.jsx(P,{contacts:p.filter(r=>{var s;return((s=r.company)==null?void 0:s.id)===t.id}),isLoading:u,defaultValues:{company:t}})},{id:"assignments",label:"Uppdrag",content:a.jsx(w,{assignments:f,isLoading:g,defaultValues:{company:t}})}]})})})})};export{ct as default};
//# sourceMappingURL=CompanyEdit-Chbf9Aid.js.map
