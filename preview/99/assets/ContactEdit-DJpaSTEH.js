import{i as h,k as j,r as m,j as o,B as I,S as k,f as n,l as v,T as S,m as L}from"./index-DyjmdRSC.js";import{A as T}from"./AssignmentTable-D7htxWdt.js";import{u as y}from"./useAssignmentsQueries-CRD4cmFv.js";import{u as A,I as B}from"./useInteractionsQueries-BhlI9peu.js";import{C as D}from"./ContentTabs-vm8iN83Q.js";import{a as F}from"./DataTable-ClRgWCj0.js";import{F as w}from"./FlexGrow-DM6v9KXX.js";import{f as E}from"./date-B17jE2Ke.js";import{u as H,a as M,b as N,C as P}from"./useContactsMutations-B2MyfrK4.js";import{a as R}from"./useContactsQueries-DP1-8nuh.js";import"./SebraDialog-BePZJB7R.js";import"./useSnackbar-BAxIYe6h.js";import"./MoreHoriz-DCo1d8Tz.js";import"./index.esm-CwNn21lM.js";import"./Tooltip-Cb2aPBE0.js";import"./useAssignmentsMutations-DlC8p0NS.js";import"./useCompaniesQueries-CKTQVe94.js";import"./useQueryParam-CIvS_JgY.js";const et=()=>{const r=h(),s=j(),{data:t,isLoading:l}=R(r.id==="new"?void 0:Number(r.id)),{mutate:d}=H(),{mutate:p}=M(),{mutate:u}=N(),{data:i=[],isLoading:g}=y(),x=m.useMemo(()=>i.filter(a=>a.responsibleContacts.some(e=>e.contactId===(t==null?void 0:t.contactId))||a.externalContactId===(t==null?void 0:t.contactId)),[i,t]),{data:c=[],isLoading:f}=A(),C=m.useMemo(()=>c.filter(a=>a.contacts.some(e=>e.contactId===(t==null?void 0:t.contactId))),[c,t]),b=a=>{t?p(a):d(a,{onSuccess:e=>s(`/home/contacts/${e.contactId}`)})};if(!l)return o.jsx(P,{formProps:{values:t},onSubmit:b,renderTopContent:()=>o.jsxs(I,{sx:{position:"relative",mt:1,mb:3},children:[o.jsxs(k,{spacing:2,direction:"row",sx:{position:"absolute",right:0},children:[t&&o.jsx(F,{onClick:()=>u(t,{onSuccess:()=>s("..")}),children:a=>o.jsx(n,{variant:"outlined",color:"error",...v(a),children:"Ta bort"})}),o.jsx(n,{variant:"outlined",color:"primary",onClick:()=>s(-1),children:"Avbryt"}),o.jsx(n,{type:"submit",variant:"contained",color:"primary",children:"Spara"})]}),o.jsx(S,{variant:"h4",color:"primary",children:t?"Redigera kontakt":"Lägg till kontakt"})]}),renderBottomContent:()=>t&&o.jsx(w,{sx:{mt:1,minHeight:`calc(100vh - ${L}px - 1rem)`},children:o.jsx(D,{tabs:[{id:"interactions",label:"Interaktioner",content:o.jsx(B,{interactions:C,isLoading:f,defaultValues:{contacts:[t],interactionDate:E()}})},{id:"seeking",label:"Söker",content:o.jsx(o.Fragment,{children:"Söker..."})},{id:"assignments",label:"Uppdrag",content:o.jsx(T,{assignments:x,isLoading:g})}]})})})};export{et as default};
