{"version":3,"file":"ContactEdit-O7l5gUSX.js","sources":["../../src/features/contacts/components/ContactEdit.tsx"],"sourcesContent":["import { useMemo } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\n\n// material-ui\nimport { Box, Typography } from '@mui/material';\n\n// project imports\nimport AssignmentTable from '@/features/assignments/components/AssignmentTable';\nimport { useAssignments } from '@/features/assignments/hooks/useAssignmentsQueries';\nimport InteractionTable from '@/features/interactions/components/InteractionTable';\nimport { useInteractions } from '@/features/interactions/hooks/useInteractionsQueries';\nimport { headerHeight } from '@/store/constant';\nimport ContentTabs from '@/ui-component/ContentTabs';\nimport FlexGrow from '@/ui-component/extended/FlexGrow';\nimport { FormActionButtons } from '@/ui-component/SebraForm';\nimport { formatDate } from '@/utils';\nimport { Contact } from '../api/contactsApi';\nimport { useCreateContact, useDeleteContact, useUpdateContact } from '../hooks/useContactsMutations';\nimport { useContact } from '../hooks/useContactsQueries';\nimport ContactForm from './ContactForm';\n\n// ==============================|| CONTACT EDIT PAGE ||============================== //\n\nconst ContactEdit = () => {\n  const params = useParams();\n  const navigate = useNavigate();\n\n  const { data: contact, isLoading } = useContact(params.id === 'new' ? undefined : Number(params.id));\n  const { mutate: createContact } = useCreateContact();\n  const { mutate: updateContact } = useUpdateContact();\n  const { mutate: deleteContact } = useDeleteContact();\n\n  const { data: allAssignments = [], isLoading: assignmentsIsLoading } = useAssignments();\n  const assignments = useMemo(\n    () =>\n      allAssignments.filter(\n        (assignment) =>\n          assignment.responsibleContacts.some((c) => c.contactId === contact?.contactId) ||\n          assignment.externalContactId === contact?.contactId\n      ),\n    [allAssignments, contact]\n  );\n  const { data: allInteractions = [], isLoading: interactionsIsLoading } = useInteractions();\n  const interactions = useMemo(\n    () => allInteractions.filter((interaction) => interaction.contacts.some((c) => c.contactId === contact?.contactId)),\n    [allInteractions, contact]\n  );\n\n  const handleSubmit = (data: Partial<Contact>) => {\n    if (contact) {\n      updateContact(data);\n    } else {\n      createContact(data, {\n        onSuccess: (res) => navigate(`/home/contacts/${res.contactId}`)\n      });\n    }\n  };\n\n  if (isLoading) return;\n\n  return (\n    <ContactForm\n      formProps={{ values: contact }}\n      onSubmit={handleSubmit}\n      renderTopContent={() => (\n        <Box sx={{ position: 'relative', mt: 1, mb: 3 }}>\n          <Typography variant=\"h4\" color=\"primary\">\n            {contact ? 'Redigera kontakt' : 'LÃ¤gg till kontakt'}\n          </Typography>\n\n          <FormActionButtons\n            sx={{ position: 'absolute', top: 0, right: 0 }}\n            onDelete={contact ? () => deleteContact(contact, { onSuccess: () => navigate('..') }) : undefined}\n            onCancel={() => navigate(-1)}\n          />\n        </Box>\n      )}\n      renderBottomContent={() =>\n        contact && (\n          <FlexGrow sx={{ mt: 1, minHeight: `calc(100vh - ${headerHeight}px - 1rem)` }}>\n            <ContentTabs\n              tabs={[\n                {\n                  id: 'interactions',\n                  label: 'Interaktioner',\n                  content: (\n                    <InteractionTable\n                      interactions={interactions}\n                      isLoading={interactionsIsLoading}\n                      defaultValues={{ contacts: [contact], interactionDate: formatDate() }}\n                    />\n                  )\n                },\n                {\n                  id: 'assignments',\n                  label: 'Uppdrag',\n                  content: <AssignmentTable assignments={assignments} isLoading={assignmentsIsLoading} />\n                }\n              ]}\n            />\n          </FlexGrow>\n        )\n      }\n    />\n  );\n};\n\nexport default ContactEdit;\n"],"names":["ContactEdit","params","useParams","navigate","useNavigate","contact","isLoading","useContact","createContact","useCreateContact","updateContact","useUpdateContact","deleteContact","useDeleteContact","allAssignments","assignmentsIsLoading","useAssignments","assignments","useMemo","assignment","c","allInteractions","interactionsIsLoading","useInteractions","interactions","interaction","handleSubmit","data","res","jsx","ContactForm","jsxs","Box","Typography","FormActionButtons","FlexGrow","headerHeight","ContentTabs","InteractionTable","formatDate","AssignmentTable"],"mappings":"qnCAuBA,MAAMA,GAAc,IAAM,CACxB,MAAMC,EAASC,IACTC,EAAWC,IAEX,CAAE,KAAMC,EAAS,UAAAC,CAAc,EAAAC,EAAWN,EAAO,KAAO,MAAQ,OAAY,OAAOA,EAAO,EAAE,CAAC,EAC7F,CAAE,OAAQO,CAAc,EAAIC,EAAiB,EAC7C,CAAE,OAAQC,CAAc,EAAIC,EAAiB,EAC7C,CAAE,OAAQC,CAAc,EAAIC,EAAiB,EAE7C,CAAE,KAAMC,EAAiB,CAAA,EAAI,UAAWC,CAAA,EAAyBC,IACjEC,EAAcC,EAAA,QAClB,IACEJ,EAAe,OACZK,GACCA,EAAW,oBAAoB,KAAMC,GAAMA,EAAE,aAAcf,GAAA,YAAAA,EAAS,UAAS,GAC7Ec,EAAW,qBAAsBd,GAAA,YAAAA,EAAS,UAC9C,EACF,CAACS,EAAgBT,CAAO,CAAA,EAEpB,CAAE,KAAMgB,EAAkB,CAAA,EAAI,UAAWC,CAAA,EAA0BC,IACnEC,EAAeN,EAAA,QACnB,IAAMG,EAAgB,OAAQI,GAAgBA,EAAY,SAAS,KAAML,GAAMA,EAAE,aAAcf,GAAA,YAAAA,EAAS,UAAS,CAAC,EAClH,CAACgB,EAAiBhB,CAAO,CAAA,EAGrBqB,EAAgBC,GAA2B,CAC3CtB,EACFK,EAAciB,CAAI,EAElBnB,EAAcmB,EAAM,CAClB,UAAYC,GAAQzB,EAAS,kBAAkByB,EAAI,SAAS,EAAE,CAAA,CAC/D,CACH,EAGE,GAAA,CAAAtB,EAGF,OAAAuB,EAAA,IAACC,EAAA,CACC,UAAW,CAAE,OAAQzB,CAAQ,EAC7B,SAAUqB,EACV,iBAAkB,IACfK,EAAA,KAAAC,EAAA,CAAI,GAAI,CAAE,SAAU,WAAY,GAAI,EAAG,GAAI,CAAA,EAC1C,SAAA,CAAAH,EAAAA,IAACI,GAAW,QAAQ,KAAK,MAAM,UAC5B,SAAA5B,EAAU,mBAAqB,mBAClC,CAAA,EAEAwB,EAAA,IAACK,EAAA,CACC,GAAI,CAAE,SAAU,WAAY,IAAK,EAAG,MAAO,CAAE,EAC7C,SAAU7B,EAAU,IAAMO,EAAcP,EAAS,CAAE,UAAW,IAAMF,EAAS,IAAI,CAAG,CAAA,EAAI,OACxF,SAAU,IAAMA,EAAS,EAAE,CAAA,CAC7B,CAAA,EACF,EAEF,oBAAqB,IACnBE,GACEwB,EAAAA,IAACM,EAAS,CAAA,GAAI,CAAE,GAAI,EAAG,UAAW,gBAAgBC,CAAY,cAC5D,SAAAP,EAAA,IAACQ,EAAA,CACC,KAAM,CACJ,CACE,GAAI,eACJ,MAAO,gBACP,QACER,EAAA,IAACS,EAAA,CACC,aAAAd,EACA,UAAWF,EACX,cAAe,CAAE,SAAU,CAACjB,CAAO,EAAG,gBAAiBkC,GAAa,CAAA,CACtE,CAEJ,EACA,CACE,GAAI,cACJ,MAAO,UACP,QAASV,EAAA,IAACW,EAAgB,CAAA,YAAAvB,EAA0B,UAAWF,EAAsB,CACvF,CACF,CAAA,CAAA,EAEJ,CAAA,CAAA,CAKV"}