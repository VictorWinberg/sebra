import{i as b,k as I,r as m,j as o,B as h,T as j,l as k}from"./index-Cvw3wisO.js";import{A as v}from"./AssignmentTable-DtyUW7u0.js";import{u as L}from"./useAssignmentsQueries-DEOrMn8B.js";import{u as F,I as S}from"./useInteractionsQueries-BgVWJ8pl.js";import{C as T}from"./ContentTabs-DxbkPEUS.js";import{F as A}from"./FlexGrow-BrxNk0Kf.js";import{F as B}from"./useSnackbar-BI1N9Jr5.js";import{f as D}from"./date-BBO4oRSY.js";import{u as y,a as E,b as w,C as H}from"./useContactsMutations-DgcpgWaG.js";import{a as M}from"./useContactsQueries-ZbRfS0Tr.js";import"./DataTable-BaHqq9z9.js";import"./useQueryParam-BDpf-YJB.js";import"./Tooltip-zDRHAwNy.js";import"./SebraDialog-DEdw4aEp.js";import"./useAssignmentsMutations-Brk2gwk1.js";import"./index.esm-BPmSvAkZ.js";import"./useCompaniesQueries-C7bD1CZ_.js";import"./MoreHoriz-ya-3STFd.js";const tt=()=>{const n=b(),a=I(),{data:t,isLoading:c}=M(n.id==="new"?void 0:Number(n.id)),{mutate:d}=y(),{mutate:l}=E(),{mutate:p}=w(),{data:i=[],isLoading:u}=L(),g=m.useMemo(()=>i.filter(s=>s.responsibleContacts.some(e=>e.contactId===(t==null?void 0:t.contactId))||s.externalContactId===(t==null?void 0:t.contactId)),[i,t]),{data:r=[],isLoading:x}=F(),f=m.useMemo(()=>r.filter(s=>s.contacts.some(e=>e.contactId===(t==null?void 0:t.contactId))),[r,t]),C=s=>{t?l(s):d(s,{onSuccess:e=>a(`/home/contacts/${e.contactId}`)})};if(!c)return o.jsx(H,{formProps:{values:t},onSubmit:C,renderTopContent:()=>o.jsxs(h,{sx:{position:"relative",mt:1,mb:3},children:[o.jsx(j,{variant:"h4",color:"primary",children:t?"Redigera kontakt":"Lägg till kontakt"}),o.jsx(B,{sx:{position:"absolute",top:0,right:0},onDelete:t?()=>p(t,{onSuccess:()=>a("..")}):void 0,onCancel:()=>a(-1)})]}),renderBottomContent:()=>t&&o.jsx(A,{sx:{mt:1,minHeight:`calc(100vh - ${k}px - 1rem)`},children:o.jsx(T,{tabs:[{id:"interactions",label:"Interaktioner",content:o.jsx(S,{interactions:f,isLoading:x,defaultValues:{contacts:[t],interactionDate:D()}})},{id:"seeking",label:"Söker",content:o.jsx(o.Fragment,{children:"Söker..."})},{id:"assignments",label:"Uppdrag",content:o.jsx(v,{assignments:g,isLoading:u})}]})})})};export{tt as default};
