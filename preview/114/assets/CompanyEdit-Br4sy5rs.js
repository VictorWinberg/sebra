import{j as a,L as b,d as C,a as y,r as x,B as h,T as j,F as L,v as D}from"./index-CtXaHwDD.js";import{A as v}from"./AssignmentTable-DGcfD_ki.js";import{u as w}from"./useAssignmentsQueries-Ci2WTuQ6.js";import{D as T}from"./DataTable-XV3k2Ibi.js";import{S as k}from"./SebraDialog-8GBg3FJS.js";import{u as F,a as I,b as E,C as S}from"./useContactsMutations-w4d9DZRh.js";import{L as A}from"./Link-4KxBUyRs.js";import{u as K}from"./useContactsQueries-Cil2HZX4.js";import{C as R}from"./ContentTabs-0WuQ4-xr.js";import{F as $}from"./SebraForm-BKjAHtj2.js";import{u as B,a as U,b as _,C as N}from"./useCompaniesMutations-BTHuVmQJ.js";import{a as V}from"./useCompaniesQueries-Vt5S_rGq.js";import"./useAssignmentsMutations-B9uD2Vvd.js";import"./index.esm-BhI5sUdE.js";import"./useQueryParam-CWSc5bZa.js";import"./Tooltip-DqZFDBNg.js";import"./createStyled-D42_Jx00.js";import"./Tabs-3zeaRt3E.js";import"./MoreHoriz-CuLgjmcs.js";import"./FormControlLabel-1Y3o4OZV.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},n=new o.Error().stack;n&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[n]="e1df2061-f323-4ffd-9c6a-f3b5a3ec91eb",o._sentryDebugIdIdentifier="sentry-dbid-e1df2061-f323-4ffd-9c6a-f3b5a3ec91eb")}catch{}})();const H=({contacts:o,isLoading:n,defaultValues:t})=>{const{mutate:m}=F(),{mutate:d}=I(),{mutate:c}=E();return a.jsx(T,{data:o,getRowId:e=>`${e.id}`,state:{isLoading:n},columns:[{accessorKey:"contactName",header:"Namn",Cell:({cell:e,row:r})=>a.jsx(A,{component:b,to:`/home/contacts/${r.original.id}`,children:e.getValue()})},{accessorKey:"email",header:"Email"},{accessorKey:"jobTitle",header:"Jobbtitel"},{accessorKey:"phone",header:"Telefonnummer"}],renderEditRowDialogContent:({row:e,table:r})=>a.jsx(k,{table:r,row:e,titles:{creating:"Lägg till kontakt",editing:"Redigera kontakt"},FormComponent:S,defaultValues:t}),onCreate:e=>m(e),onUpdate:e=>d(e),onDelete:e=>c(e)})},mt=()=>{const o=C(),n=y(),{data:t,isLoading:m}=V(o.id==="new"?void 0:o.id),{mutate:d}=B(),{mutate:c}=U(),{mutate:e}=_(),{data:r=[],isLoading:p}=K(),{data:l=[],isLoading:u}=w(),g=x.useMemo(()=>l.filter(i=>{var s;return((s=i.company)==null?void 0:s.id)===(t==null?void 0:t.id)}),[l,t]),f=i=>{t?c({...i,id:t.id}):d(i,{onSuccess:({createCompany:s})=>n(`/home/companies/${(s==null?void 0:s.id)||""}`)})};if(!m)return a.jsx(a.Fragment,{children:a.jsx(N,{formProps:{values:t},onSubmit:f,renderTopContent:()=>a.jsxs(h,{sx:{position:"relative",mt:1,mb:3},children:[a.jsx(j,{variant:"h4",color:"primary",children:t?"Redigera bolag":"Lägg till bolag"}),a.jsx($,{sx:{position:"absolute",top:0,right:0},onDelete:t?()=>e(t,{onSuccess:()=>n("..")}):void 0,onCancel:()=>n(-1)})]}),renderBottomContent:()=>t&&a.jsx(L,{sx:{mt:1,minHeight:`calc(100vh - ${D}px - 1rem)`},children:a.jsx(R,{tabs:[{id:"contacts",label:"Kontakter",content:a.jsx(H,{contacts:r.filter(i=>{var s;return((s=i.company)==null?void 0:s.id)===t.id}),isLoading:p,defaultValues:{company:t}})},{id:"assignments",label:"Uppdrag",content:a.jsx(v,{assignments:g,isLoading:u,defaultValues:{company:t}})}]})})})})};export{mt as default};
//# sourceMappingURL=CompanyEdit-Br4sy5rs.js.map
