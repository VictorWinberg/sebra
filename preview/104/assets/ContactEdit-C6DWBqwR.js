import{k as I,l as b,r as m,j as o,B as h,T as j,F as v,m as L}from"./index-BzkFRqDI.js";import{A as k}from"./AssignmentTable-C-nmo30_.js";import{u as T}from"./useAssignmentsQueries-CvCC9xRv.js";import{u as A,I as F}from"./useInteractionsQueries-BTRNsRKH.js";import{C as B}from"./ContentTabs-CxWjykgz.js";import{F as D}from"./useSnackbar-jRacW-mS.js";import{f as S}from"./date-CK5HKMz2.js";import{u as y,a as E,b as w,C as H}from"./useContactsMutations-CxfxeAo7.js";import{a as M}from"./useContactsQueries-8yE_gSee.js";import"./DataTable-DUGFV4QA.js";import"./useQueryParam-4e8L4EYV.js";import"./Tooltip-CbnF0fP4.js";import"./SebraDialog-Dw7cExYl.js";import"./useAssignmentsMutations-uVpIQ8qF.js";import"./index.esm-ce09msfH.js";import"./useCompaniesQueries-Bt1v90gs.js";import"./Tabs-fcE8mwy6.js";import"./MoreHoriz-6iwLalLo.js";const tt=()=>{const n=I(),e=b(),{data:t,isLoading:c}=M(n.id==="new"?void 0:Number(n.id)),{mutate:d}=y(),{mutate:p}=E(),{mutate:l}=w(),{data:i=[],isLoading:u}=T(),g=m.useMemo(()=>i.filter(s=>s.responsibleContacts.some(a=>a.contactId===(t==null?void 0:t.contactId))||s.externalContactId===(t==null?void 0:t.contactId)),[i,t]),{data:r=[],isLoading:x}=A(),f=m.useMemo(()=>r.filter(s=>s.contacts.some(a=>a.contactId===(t==null?void 0:t.contactId))),[r,t]),C=s=>{t?p(s):d(s,{onSuccess:a=>e(`/home/contacts/${a.contactId}`)})};if(!c)return o.jsx(H,{formProps:{values:t},onSubmit:C,renderTopContent:()=>o.jsxs(h,{sx:{position:"relative",mt:1,mb:3},children:[o.jsx(j,{variant:"h4",color:"primary",children:t?"Redigera kontakt":"LÃ¤gg till kontakt"}),o.jsx(D,{sx:{position:"absolute",top:0,right:0},onDelete:t?()=>l(t,{onSuccess:()=>e("..")}):void 0,onCancel:()=>e(-1)})]}),renderBottomContent:()=>t&&o.jsx(v,{sx:{mt:1,minHeight:`calc(100vh - ${L}px - 1rem)`},children:o.jsx(B,{tabs:[{id:"interactions",label:"Interaktioner",content:o.jsx(F,{interactions:f,isLoading:x,defaultValues:{contacts:[t],interactionDate:S()}})},{id:"assignments",label:"Uppdrag",content:o.jsx(k,{assignments:g,isLoading:u})}]})})})};export{tt as default};
