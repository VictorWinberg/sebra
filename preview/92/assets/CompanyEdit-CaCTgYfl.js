import{j as t,g as x,L as h,i as y,k as j,B as b,S as f,f as p,l as k,T as I}from"./index-Cb92esh7.js";import{A as v}from"./AssignmentTable-DDraT3GD.js";import{u as T}from"./useAssignmentsQueries-CKLyzH17.js";import{D as L,a as D,b as S,M as F}from"./useSnackbar-BO7AuKFX.js";import{D as K,a as R}from"./DataTable-DFMlW2_u.js";import{u as A,a as B,b as E,C as w}from"./useContactsMutations-Cn9zjaXp.js";import{u as N}from"./useContactsQueries-C6cu2fJG.js";import{C as P}from"./ContentTabs-Do7i-epM.js";import{F as U}from"./FlexGrow-DDYQqbDr.js";import{u as $,a as V,b as M,C as Y}from"./useCompaniesMutations-BLuYq4Z4.js";import{a as _}from"./useCompaniesQueries-wbvMxk55.js";import"./useAssignmentsMutations-rShx42oT.js";import"./index.esm-CeMCaMQX.js";import"./MoreHoriz-DeyYpqij.js";import"./Tooltip-CURAw7_K.js";import"./useQueryParam-DfTgo7W8.js";const G=({contacts:r,isLoading:s,defaultValues:e})=>{const{mutate:c}=A(),{mutate:m}=B(),{mutate:l}=E();return t.jsx(K,{data:r,getRowId:a=>`${a.contactId}`,state:{isLoading:s},columns:[{accessorKey:"contactName",header:"Namn",Cell:({cell:a,row:o})=>t.jsx(x,{component:h,to:`/home/contacts/${o.original.contactId}`,children:a.getValue()})},{accessorKey:"email",header:"Email"},{accessorKey:"jobTitle",header:"Jobbtitel"},{accessorKey:"phone",header:"Telefonnummer"}],renderEditRowDialogContent:({row:a,table:o})=>t.jsxs(t.Fragment,{children:[t.jsx(L,{variant:"h4",color:"primary",children:o.getState().creatingRow?"Lägg till kontakt":"Redigera kontakt"}),t.jsx(D,{children:t.jsx(w,{sx:{mt:1},formProps:{defaultValues:{...e,...a.original}},onChange:d=>{a._valuesCache=d}})}),t.jsx(S,{children:t.jsx(F,{row:a,table:o,variant:"text"})})]}),onCreate:a=>c(a),onUpdate:a=>m(a),onDelete:a=>l(a)})},it=()=>{const r=y(),s=j(),{data:e,isLoading:c}=_(r.id==="new"?void 0:Number(r.id)),{mutate:m}=$(),{mutate:l}=V(),{mutate:a}=M(),{data:o=[],isLoading:d}=N(),{data:u=[],isLoading:g}=T(),C=n=>{e?l(n):m(n,{onSuccess:i=>s(`/home/companies/${i.companyId}`)})};if(!c)return t.jsx(t.Fragment,{children:t.jsx(Y,{formProps:{values:e},onSubmit:C,renderTopContent:()=>t.jsxs(b,{sx:{position:"relative",mt:1,mb:3},children:[t.jsxs(f,{spacing:2,direction:"row",sx:{position:"absolute",right:0},children:[e&&t.jsx(R,{onClick:()=>a(e,{onSuccess:()=>s("..")}),children:n=>t.jsx(p,{variant:"outlined",color:"error",...k(n),children:"Ta bort"})}),t.jsx(p,{variant:"outlined",color:"primary",onClick:()=>s(-1),children:"Avbryt"}),t.jsx(p,{type:"submit",variant:"contained",color:"primary",children:"Spara"})]}),t.jsx(I,{variant:"h4",color:"primary",children:e?"Redigera bolag":"Lägg till bolag"})]}),renderBottomContent:()=>e&&t.jsx(U,{sx:{mt:1},children:t.jsx(P,{tabs:[{id:"interactions",label:"Interaktioner",content:t.jsx(t.Fragment,{children:"Interaktioner..."})},{id:"contacts",label:"Kontakter",content:t.jsx(G,{contacts:o.filter(n=>n.companyId===e.companyId),isLoading:d,defaultValues:{companyId:e.companyId}})},{id:"seeking",label:"Söker",content:t.jsx(t.Fragment,{children:"Söker..."})},{id:"assignments",label:"Uppdrag",content:t.jsx(v,{assignments:u.filter(n=>{var i;return((i=n.externalContactPerson)==null?void 0:i.companyId)===e.companyId}),isLoading:g})},{id:"kyc",label:"KYC",content:t.jsx(t.Fragment,{children:"KYC..."})}]})})})})};export{it as default};
