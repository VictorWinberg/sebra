import{j as a,i as x,L as f,l as h,g as b,r as y,B as j,T as L,F as T,m as v}from"./index-B5Wn1pV6.js";import{A as D}from"./AssignmentTable-C17khZAT.js";import{u as F}from"./useAssignmentsQueries-CLWaiOM8.js";import{D as k}from"./DataTable-CHC-0lOI.js";import{S as I}from"./SebraDialog-DMHdke9R.js";import{u as S,a as A,b as E,C as K}from"./useContactsMutations-DWwD5Kct.js";import{u as R}from"./useContactsQueries-D3qhIykf.js";import{C as $}from"./ContentTabs-ixOlLe5c.js";import{F as w}from"./useSnackbar-DKcC1YFu.js";import{u as B,a as U,b as N,C as V}from"./useCompaniesMutations-B1oLkbW6.js";import{a as H}from"./useCompaniesQueries-Bc9ksEnf.js";import"./useAssignmentsMutations-bNKWUxIP.js";import"./index.esm-DVlgypon.js";import"./useQueryParam-B9tnBKyX.js";import"./Tooltip-BOs_SEaO.js";import"./Tabs-CVL9e8Ya.js";import"./MoreHoriz-1-Hni6Yv.js";const P=({contacts:i,isLoading:s,defaultValues:t})=>{const{mutate:r}=S(),{mutate:m}=A(),{mutate:c}=E();return a.jsx(k,{data:i,getRowId:e=>`${e.id}`,state:{isLoading:s},columns:[{accessorKey:"contactName",header:"Namn",Cell:({cell:e,row:n})=>a.jsx(x,{component:f,to:`/home/contacts/${n.original.id}`,children:e.getValue()})},{accessorKey:"email",header:"Email"},{accessorKey:"jobTitle",header:"Jobbtitel"},{accessorKey:"phone",header:"Telefonnummer"}],renderEditRowDialogContent:({row:e,table:n})=>a.jsx(I,{table:n,row:e,titles:{creating:"Lägg till kontakt",editing:"Redigera kontakt"},FormComponent:K,defaultValues:t}),onCreate:e=>r(e),onUpdate:e=>m(e),onDelete:e=>c(e)})},nt=()=>{const i=h(),s=b(),{data:t,isLoading:r}=H(i.id==="new"?void 0:i.id),{mutate:m}=B(),{mutate:c}=U(),{mutate:e}=N(),{data:n=[],isLoading:l}=R(),{data:d=[],isLoading:p}=F(),u=y.useMemo(()=>d.filter(o=>o.companyId===(t==null?void 0:t.id)),[d,t]),g=o=>{t?c(o):m(o,{onSuccess:C=>s(`/home/companies/${C.id}`)})};if(!r)return a.jsx(a.Fragment,{children:a.jsx(V,{formProps:{values:t},onSubmit:g,renderTopContent:()=>a.jsxs(j,{sx:{position:"relative",mt:1,mb:3},children:[a.jsx(L,{variant:"h4",color:"primary",children:t?"Redigera bolag":"Lägg till bolag"}),a.jsx(w,{sx:{position:"absolute",top:0,right:0},onDelete:t?()=>e(t,{onSuccess:()=>s("..")}):void 0,onCancel:()=>s(-1)})]}),renderBottomContent:()=>t&&a.jsx(T,{sx:{mt:1,minHeight:`calc(100vh - ${v}px - 1rem)`},children:a.jsx($,{tabs:[{id:"contacts",label:"Kontakter",content:a.jsx(P,{contacts:n.filter(o=>o.companyId===t.id),isLoading:l,defaultValues:{companyId:t.id}})},{id:"assignments",label:"Uppdrag",content:a.jsx(D,{assignments:u,isLoading:p,defaultValues:{companyId:t.id}})}]})})})})};export{nt as default};
