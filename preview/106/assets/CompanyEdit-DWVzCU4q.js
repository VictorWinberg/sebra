import{j as a,h as x,L as h,k as f,l as b,r as y,B as j,T as L,F as T,m as k}from"./index-L1L35c__.js";import{A as v}from"./AssignmentTable-0vVXgDV8.js";import{u as D}from"./useAssignmentsQueries-Bbd2EWdx.js";import{D as F}from"./DataTable-5WJgMj7Y.js";import{S as I}from"./SebraDialog-CfxupOjU.js";import{u as S,a as A,b as E,C as K}from"./useContactsMutations-YeUCFAHM.js";import{u as R}from"./useContactsQueries-Cwh-UZ5n.js";import{C as $}from"./ContentTabs-sWF0dolc.js";import{F as w}from"./useSnackbar-DZ6xs5-N.js";import{u as B,a as U,b as N,C as V}from"./useCompaniesMutations-3JQN2PT4.js";import{a as H}from"./useCompaniesQueries-Q_w3bqQq.js";import"./useAssignmentsMutations-0cbX5wjP.js";import"./index.esm-Dqgv-uXP.js";import"./useQueryParam-ehg0XFZT.js";import"./Tooltip-DsDj3qVP.js";import"./Tabs-BtPJqpS7.js";import"./MoreHoriz-y-vap74H.js";const P=({contacts:i,isLoading:s,defaultValues:t})=>{const{mutate:r}=S(),{mutate:m}=A(),{mutate:c}=E();return a.jsx(F,{data:i,getRowId:e=>`${e.id}`,state:{isLoading:s},columns:[{accessorKey:"contactName",header:"Namn",Cell:({cell:e,row:n})=>a.jsx(x,{component:h,to:`/home/contacts/${n.original.id}`,children:e.getValue()})},{accessorKey:"email",header:"Email"},{accessorKey:"jobTitle",header:"Jobbtitel"},{accessorKey:"phone",header:"Telefonnummer"}],renderEditRowDialogContent:({row:e,table:n})=>a.jsx(I,{table:n,row:e,titles:{creating:"Lägg till kontakt",editing:"Redigera kontakt"},FormComponent:K,defaultValues:t}),onCreate:e=>r(e),onUpdate:e=>m(e),onDelete:e=>c(e)})},nt=()=>{const i=f(),s=b(),{data:t,isLoading:r}=H(i.id==="new"?void 0:i.id),{mutate:m}=B(),{mutate:c}=U(),{mutate:e}=N(),{data:n=[],isLoading:l}=R(),{data:d=[],isLoading:p}=D(),u=y.useMemo(()=>d.filter(o=>o.companyId===(t==null?void 0:t.id)),[d,t]),g=o=>{t?c(o):m(o,{onSuccess:C=>s(`/home/companies/${C.id}`)})};if(!r)return a.jsx(a.Fragment,{children:a.jsx(V,{formProps:{values:t},onSubmit:g,renderTopContent:()=>a.jsxs(j,{sx:{position:"relative",mt:1,mb:3},children:[a.jsx(L,{variant:"h4",color:"primary",children:t?"Redigera bolag":"Lägg till bolag"}),a.jsx(w,{sx:{position:"absolute",top:0,right:0},onDelete:t?()=>e(t,{onSuccess:()=>s("..")}):void 0,onCancel:()=>s(-1)})]}),renderBottomContent:()=>t&&a.jsx(T,{sx:{mt:1,minHeight:`calc(100vh - ${k}px - 1rem)`},children:a.jsx($,{tabs:[{id:"contacts",label:"Kontakter",content:a.jsx(P,{contacts:n.filter(o=>o.companyId===t.id),isLoading:l,defaultValues:{companyId:t.id}})},{id:"assignments",label:"Uppdrag",content:a.jsx(v,{assignments:u,isLoading:p,defaultValues:{companyId:t.id}})}]})})})})};export{nt as default};
