import{k as b,l as h,r as m,j as s,B as j,T as v,F as I,m as L}from"./index-L1L35c__.js";import{A as k}from"./AssignmentTable-0vVXgDV8.js";import{u as T}from"./useAssignmentsQueries-Bbd2EWdx.js";import{u as A,I as F}from"./useInteractionsQueries-BqmhuMr3.js";import{C as B}from"./ContentTabs-sWF0dolc.js";import{F as D}from"./useSnackbar-DZ6xs5-N.js";import{f as S}from"./date-CwZn5mgt.js";import{u as y,a as E,b as w,C as H}from"./useContactsMutations-YeUCFAHM.js";import{a as M}from"./useContactsQueries-Cwh-UZ5n.js";import"./DataTable-5WJgMj7Y.js";import"./useQueryParam-ehg0XFZT.js";import"./Tooltip-DsDj3qVP.js";import"./SebraDialog-CfxupOjU.js";import"./useAssignmentsMutations-0cbX5wjP.js";import"./index.esm-Dqgv-uXP.js";import"./useCompaniesQueries-Q_w3bqQq.js";import"./Tabs-BtPJqpS7.js";import"./MoreHoriz-y-vap74H.js";const tt=()=>{const n=b(),a=h(),{data:t,isLoading:c}=M(n.id==="new"?void 0:n.id),{mutate:d}=y(),{mutate:p}=E(),{mutate:l}=w(),{data:i=[],isLoading:u}=T(),g=m.useMemo(()=>i.filter(o=>o.responsibleContacts.some(e=>e.id===(t==null?void 0:t.id))||o.externalContactId===(t==null?void 0:t.id)),[i,t]),{data:r=[],isLoading:x}=A(),f=m.useMemo(()=>r.filter(o=>o.contacts.some(e=>e.id===(t==null?void 0:t.id))),[r,t]),C=o=>{t?p(o):d(o,{onSuccess:e=>a(`/home/contacts/${e.id}`)})};if(!c)return s.jsx(H,{formProps:{values:t},onSubmit:C,renderTopContent:()=>s.jsxs(j,{sx:{position:"relative",mt:1,mb:3},children:[s.jsx(v,{variant:"h4",color:"primary",children:t?"Redigera kontakt":"LÃ¤gg till kontakt"}),s.jsx(D,{sx:{position:"absolute",top:0,right:0},onDelete:t?()=>l(t,{onSuccess:()=>a("..")}):void 0,onCancel:()=>a(-1)})]}),renderBottomContent:()=>t&&s.jsx(I,{sx:{mt:1,minHeight:`calc(100vh - ${L}px - 1rem)`},children:s.jsx(B,{tabs:[{id:"interactions",label:"Interaktioner",content:s.jsx(F,{interactions:f,isLoading:x,defaultValues:{contacts:[t],interactionDate:S()}})},{id:"assignments",label:"Uppdrag",content:s.jsx(k,{assignments:g,isLoading:u})}]})})})};export{tt as default};
